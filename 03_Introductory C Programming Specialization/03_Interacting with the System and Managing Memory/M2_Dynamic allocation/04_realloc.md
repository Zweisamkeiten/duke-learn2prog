---
date created: 2022-10-19 17:48
date updated: 2022-10-19 18:01
---

## realloc

响应这种增加的空间需求的正确方法是使用 **realloc**. realloc 移动旧内存中的数据到新的更大的内存, 释放旧内存, 返回新内存地址指针.
但是也可能有这种需求, 原先使用的内存太大了,希望释放掉一部分. realloc 会 malloc 一块小内存, 然后将旧内存中的数据按新的小内存的长度截断后复制, 然后返回指针. (因此realloc **可能** 会重用相同的地址. 仅仅是完成了截断这一工作.)

realloc **可能** 会重用相同的地址, 如果是请求更大的内存, 而原先内存后的空间正好充足, 因此会重用原来的内存空间.
![](attachments/Pasted%20image%2020221019175649.png)

![](attachments/Pasted%20image%2020221019175301.png)

**realloc** 有效地调整分配的内存区域的大小.  realloc 的参数是指向您希望调整大小的内存区域的指针以及您希望内存中的区域具有的新大小。 如果成功，realloc 将返回一个指针，指向堆中现在可供您使用的新的、更大的位置。 如果请求大小的堆中没有可用的区域，realloc 将返回 NULL.

#newget #realloc #important
**请记住，内存中的新位置不需要位于堆中原始位置附近的任何位置。** 但它会将原先位置的数据移至新位置. 就我们的储物柜类比而言，如果您回到窗口并说“我的储物柜从 37 号储物柜开始，但我现在需要 6 个储物柜”，工作人员可能无法给您 42 号储物柜。相反，工作人员可能会回应“好吧，你的新的首个储物柜是 12 。” 方便的是，工作人员会为您将 37-41 号储物柜中的物品移到 12-16 号储物柜中。

**calloc** （它会为您清零内存中的区域——相比之下，malloc 不会初始化内存）
